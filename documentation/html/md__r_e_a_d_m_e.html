<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>esp32_BNO08x: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">esp32_BNO08x<span id="projectnumber">&#160;1.1</span>
   </div>
   <div id="projectbrief">C++ BNO08x IMU driver component for esp-idf.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">README</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Table of Contents.</p>
<p><a class="anchor" id="readme-top"></a> <img src="esp32_BNO08x_banner.png" alt="image" class="inline"/></p>
<ol>
<li>
<a href="#about">About</a>  </li>
<li>
<a href="#getting-started">Getting Started</a> <ul>
<li>
<a href="#wiring">Wiring</a> </li>
<li>
<a href="#adding-to-project">Adding to Project</a> </li>
<li>
<a href="#menuconfig">Menuconfig</a> </li>
<li>
<a href="#examples">Examples</a> </li>
</ul>
</li>
<li>
<a href="#documentation">Documentation</a> </li>
<li>
<a href="#program-flowcharts">Program Flowcharts</a> </li>
<li>
<a href="#acknowledgements">Acknowledgements</a> </li>
<li>
<a href="#license">License</a> </li>
<li>
<a href="#contact">Contact</a> </li>
</ol>
<h2><a class="anchor" id="autotoc_md0"></a>
About</h2>
<p>esp32_BNO08x is a C++ component for esp-idf v5.x, serving as a driver for both BNO080 and BNO085 IMUs. <br  />
</p>
<p>Originally based on the SparkFun BNO080 Arduino Library, it has since diverged significantly in implementation while retaining all original features and more, including callback functions enabled by its multi-tasked approach.</p>
<p>Currently, only SPI is supported. There are no plans to support I2C due to unpredictable behavior caused by an esp32 I2C driver silicon bug. UART support may be implemented in the future.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Getting Started</h2>
<p>(<a href="#readme-top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md2"></a>
Wiring</h3>
<p>The default wiring is depicted below, it can be changed at driver initialization (see example section). <br  />
</p>
<p>If your ESP does not have the GPIO pin numbers depicted below, you <b>must change the default GPIO settings in menuconfig</b>. See the Menuconfig section.</p>
<p align="right"><img src="esp32_BNO08x_wiring.png" alt="image" class="inline"/> </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md3"></a>
Adding to Project</h3>
<ol type="1">
<li><p class="startli">Create a "components" directory in the root workspace directory of your esp-idf project if it does not exist already. <br  />
</p>
<p class="startli">In workspace directory: <br  />
 </p><div class="fragment"><div class="line">mkdir components</div>
</div><!-- fragment --></li>
<li><p class="startli">Cd into the components directory and clone the esp32_BNO08x repo.</p>
<div class="fragment"><div class="line">cd components</div>
<div class="line">git clone https://github.com/myles-parfeniuk/esp32_BNO08x.git</div>
</div><!-- fragment --></li>
<li>Ensure you clean your esp-idf project before rebuilding. <br  />
 Within esp-idf enabled terminal: <div class="fragment"><div class="line">idf.py fullclean</div>
</div><!-- fragment --> </li>
</ol>
<p>(<a href="#readme-top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md4"></a>
Menuconfig</h3>
<p>This library provides a menuconfig menu configured in Kconfig.projbuild. It contains settings to control the default GPIO and a few other things. <br  />
</p>
<p>To access the menu:</p>
<ol type="1">
<li>Within esp-idf enabled terminal, execute the menuconfig command: <div class="fragment"><div class="line">    idf.py menuconfig</div>
<div class="line"> </div>
<div class="line">2. Scroll down to the esp_BNO08x menu and enter it, if you&#39;re using vsCode you may have to use the &quot;j&quot; and &quot;k&quot; keys instead of the arrow keys.</div>
<div class="line">    ![image](esp32_BNO08x_menuconfig_1.png)</div>
<div class="line"> </div>
<div class="line">3. Modify whatever settings you&#39;d like from the sub menus. The GPIO Configuration menu allows for the default GPIO pins to be modified, the SPI Configuration menu allows for the default SCLK frequency and host peripheral to be modified.</div>
<div class="line">    ![image](esp32_BNO08x_menuconfig_2.png)</div>
<div class="line">&lt;p align=&quot;right&quot;&gt;(&lt;a href=&quot;#readme-top&quot;&gt;back to top&lt;/a&gt;)&lt;/p&gt;</div>
<div class="line"> </div>
<div class="line">### Examples</div>
<div class="line">There are two ways data returned from the BNO08x can be accessed with this library:</div>
<div class="line"> </div>
<div class="line">1. Polling Method with `data_available()` Function:</div>
<div class="line">  - Use the `data_available()` function to poll for new data, similar to the SparkFun library.</div>
<div class="line">  - Behavior: It is a blocking function that returns `true` when new data is received or `false` if a timeout occurs.</div>
<div class="line">  - See the **Polling Example** below.</div>
<div class="line"> </div>
<div class="line">2. Callback Registration with `register_cb()` Function:</div>
<div class="line">  - Register callback functions that automatically execute upon receiving new data.</div>
<div class="line">  - Behavior: The registered callback will be invoked whenever new data is available.</div>
<div class="line">  - See the **Call-Back Function Example** below. </div>
<div class="line">  </div>
<div class="line">#### Polling Example</div>
</div><!-- fragment --> cpp #include &lt;stdio.h&gt; #include "BNO08x.hpp"</li>
</ol>
<p>extern "C" void app_main(void) { <a class="el" href="class_b_n_o08x.html">BNO08x</a> imu; //create IMU object with default wiring scheme float x, y, z = 0;</p>
<p>//if a custom wiring scheme is desired instead of default:</p>
<p>/* <a class="el" href="structbno08x__config__t.html" title="IMU configuration settings passed into constructor.">bno08x_config_t</a> imu_config; //create config struct imu_config.io_mosi = GPIO_NUM_X; //assign pin imu_config.io_miso = GPIO_NUM_X; //assign pin //etc... <a class="el" href="class_b_n_o08x.html">BNO08x</a> imu(imu_config); //pass config to <a class="el" href="class_b_n_o08x.html">BNO08x</a> constructor */</p>
<p>imu.initialize(); //initialize IMU</p>
<p>//enable gyro &amp; game rotation vector imu.enable_game_rotation_vector(100000UL); //100,000us == 100ms report interval imu.enable_gyro(150000UL); //150,000us == 150ms report interval</p>
<p>while(1) { //print absolute heading in degrees and angular velocity in Rad/s if(imu.data_available()) { x = imu.get_gyro_calibrated_velocity_X(); y = imu.get_gyro_calibrated_velocity_Y(); z = imu.get_gyro_calibrated_velocity_Z(); ESP_LOGW("Main", "Velocity: x: %.3f y: %.3f z: %.3f", x, y, z);</p>
<p>x = imu.get_roll_deg(); y = imu.get_pitch_deg(); z = imu.get_yaw_deg(); ESP_LOGI("Main", "Euler Angle: x (roll): %.3f y (pitch): %.3f z (yaw): %.3f", x, y, z); } }</p>
<p>} </p><div class="fragment"><div class="line">#### Call-Back Function Example</div>
</div><!-- fragment --><p> cpp #include &lt;stdio.h&gt; #include "BNO08x.hpp"</p>
<p>extern "C" void app_main(void) { <a class="el" href="class_b_n_o08x.html">BNO08x</a> imu; // create IMU object with default wiring scheme</p>
<p>// if a custom wiring scheme is desired instead of default:</p>
<p>/* <a class="el" href="structbno08x__config__t.html" title="IMU configuration settings passed into constructor.">bno08x_config_t</a> imu_config; //create config struct imu_config.io_mosi = GPIO_NUM_X; //assign pin imu_config.io_miso = GPIO_NUM_X; //assign pin //etc... <a class="el" href="class_b_n_o08x.html">BNO08x</a> imu(imu_config); //pass config to <a class="el" href="class_b_n_o08x.html">BNO08x</a> constructor */</p>
<p>imu.initialize(); // initialize IMU</p>
<p>// enable gyro &amp; game rotation vector imu.enable_game_rotation_vector(100000UL); // 100,000us == 100ms report interval imu.enable_gyro(150000UL); // 150,000us == 150ms report interval</p>
<p>// register a callback function (in this case a lambda function, but it doesn't have to be) imu.register_cb( [&amp;imu]() { // callback function contents, executed whenever new data is parsed // print absolute heading in degrees and angular velocity in Rad/s float x, y, z = 0; x = imu.get_gyro_calibrated_velocity_X(); y = imu.get_gyro_calibrated_velocity_Y(); z = imu.get_gyro_calibrated_velocity_Z(); ESP_LOGW("Main", "Velocity: x: %.3f y: %.3f z: %.3f", x, y, z);</p>
<p>x = imu.get_roll_deg(); y = imu.get_pitch_deg(); z = imu.get_yaw_deg(); ESP_LOGI("Main", "Euler Angle: x (roll): %.3f y (pitch): %.3f z (yaw): %.3f", x, y, z); });</p>
<p align="right">while (1) { vTaskDelay(300 / portTICK_PERIOD_MS); // delay here is irrelevant, we just don't want to trip cpu watchdog } } ``` </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Documentation</h2>
<p align="right">API documentation generated with doxygen can be found in the documentation directory of the master branch. <br  />
 </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Program Flowcharts</h2>
<p>The following charts illustrate the program flow this library implements for sending and receiving data from <a class="el" href="class_b_n_o08x.html">BNO08x</a>. <br  />
 These are here to aid development for anyone looking to modify, fork, or contribute. <br  />
</p>
<p align="right"><img src="esp32_BNO08x_flowchart.png" alt="image" class="inline"/> </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Acknowledgements</h2>
<p>Special thanks to the original creators of the sparkfun BNO080 library. Developing this without a reference would have been much more time consuming. <br  />
 <a href="https://github.com/sparkfun/SparkFun_BNO080_Arduino_Library">https://github.com/sparkfun/SparkFun_BNO080_Arduino_Library</a> <br  />
</p>
<p>Special thanks to Anton Babiy, aka hwBirdy007 for helping with debugging SPI. <br  />
 <a href="https://github.com/hwBirdy007">https://github.com/hwBirdy007</a> <br  />
</p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md8"></a>
License</h2>
<p align="right">Distributed under the MIT License. See <code>LICENSE.md</code> for more information. </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Contact</h2>
<p>Myles Parfeniuk - <a href="#" onclick="location.href='mai'+'lto:'+'myl'+'es'+'.pa'+'rf'+'eny'+'uk'+'@gm'+'ai'+'l.c'+'om'; return false;">myles<span class="obfuscator">.nosp@m.</span>.par<span class="obfuscator">.nosp@m.</span>fenyu<span class="obfuscator">.nosp@m.</span>k@gm<span class="obfuscator">.nosp@m.</span>ail.c<span class="obfuscator">.nosp@m.</span>om</a></p>
<p align="right">Project Link: <a href="https://github.com/myles-parfeniuk/esp32_BNO08x.git">https://github.com/myles-parfeniuk/esp32_BNO08x.git</a> </p>
<p>(<a href="#readme-top">back to top</a>)</p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
